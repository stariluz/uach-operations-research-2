
A partir de la solución óptima del primal, obten y_i:

Tomamos la tabla final del primal (problema original).
Dame la óptima del dual.

### Método 1
$\text{Valor óptimo de variable dual } y_i = \text{Coeficiente primal óptimo de la variable inicial } x_i + \text{Coeficiente objetivo original de} x_i$


### Método 2
$\textrm{Valores óptimos de las vairables duales } = \textrm{Vector fila de los coeficientes objetivos originales de las variables básicas primales óptimas} \times \text{inversa primal óptima}$

---
# Ejercicio

$Maximizar Z = 5x_1 + 12x_2 + 4x_3$

Sujeto a

$x_1 + 2x_2 + x_3 \leq 10$

$2x_1 - x_2 + 3x_3 = 8$

$x_1, x_2, x_3\geq0$

### Ecuaciones

$Z - 5x_1 - 12x_2 - 4x_3 + 0s_1 + 0R_1 = 0$

$x_1 + 2x_2 + x_3 + s_1 = 10$

$2x_1 - x_2 + 3x_3 + R_1 = 8$

## Metodo 2 fases

$Min r=R_1$

$r-R_1=0$

$x_1 + 2x_2 + x_3 + s_1 = 10$

$2x_1 - x_2 + 3x_3 + R_1 = 8$

### Tabla inicial

| $V_B$ | $r$ | $x_1$ | $x_2$ | $x_3$ | $s_1$ | $R_1$ | $Solución$ |
| ----- | --- | ----- | ----- | ----- | ----- | ----- | ---------- |
| $r$   | $1$ | $0$   | $0$   | $0$   | $0$   | $-1$  | $0$        |
| $s_1$ | $0$ | $1$   | $2$   | $1$   | $1$   | $0$   | $10$       |
| $R_1$ | $0$ | $2$   | $-1$  | $3$   | $0$   | $1$   | $8$        |

### Corregir r
Se suman $r+R_1$ para convertir r a 0.

$\textrm{Nueva fila }r \to \text{Fila actual }r+C_1R_1$

Donde $C_1$ es el coeficiente que anula el valor de la fila $r$ en la columna $R_1$, en este caso es $1$.

| $V_B$           | $r$ | $x_1$ | $x_2$ | $x_3$ | $s_1$ | $R_1$ | $Solución$ |
| --------------- | --- | ----- | ----- | ----- | ----- | ----- | ---------- |
| $r$             | $1$ | $0$   | $0$   | $0$   | $0$   | $-1$  | $0$        |
| $1R_1$          | $0$ | $2$   | $-1$  | $3$   | $0$   | $1$   | $8$        |
| $r \to r+1R_1+$ | $1$ | $2$   | $-1$  | $3$   | $0$   | $0$   | $8$        |

### Tabla inicial ajustada

| $V_B$ | $r$ | $x_1$ | $x_2$ | $x_3$ | $s_1$ | $R_1$ | $Solución$ |
| ----- | --- | ----- | ----- | ----- | ----- | ----- | ---------- |
| $r$   | $1$ | $2$   | $-1$  | $3$   | $0$   | $0$   | $8$        |
| $s_1$ | $0$ | $1$   | $2$   | $1$   | $1$   | $0$   | $10$       |
| $R_1$ | $0$ | $2$   | $-1$  | $3$   | $0$   | $1$   | $8$        |

## Primera iteración

#### $V_E$ y $V_P$

$V_E=x_3$

| $V_B$ | Columna $V_E$ | Columna $Solución$ | Relación mínima   | Válida |
| ----- | ------------- | ------------------ | ----------------- | ------ |
| $s_1$ | $1$           | $10$               | $\frac{10}{1}=10$ | Sí     |
| $R_1$ | $3$           | $8$                | ==$\frac{8}{3}$== | Sí     |

$V_P = R_1$

#### Actualizar fila $V_P$

| $V_B$         | $r$ | $x_1$         | $x_2$          | $x_3$ | $s_1$ | $R_1$         | $Solución$    |
| ------------- | --- | ------------- | -------------- | ----- | ----- | ------------- | ------------- |
| $R_1 \to x_3$ | $0$ | $\frac{2}{3}$ | $\frac{-1}{3}$ | $1$   | $0$   | $\frac{1}{3}$ | $\frac{8}{3}$ |

| $V_B$ | $r$ | $x_1$         | $x_2$          | $x_3$ | $s_1$ | $R_1$         | $Solución$    |
| ----- | --- | ------------- | -------------- | ----- | ----- | ------------- | ------------- |
| $r$   | $1$ | $2$           | $-1$           | $3$   | $0$   | $0$           | $8$           |
| $s_1$ | $0$ | $1$           | $2$            | $1$   | $1$   | $0$           | $10$          |
| $x_3$ | $0$ | $\frac{2}{3}$ | $\frac{-1}{3}$ | $1$   | $0$   | $\frac{1}{3}$ | $\frac{8}{3}$ |

#### Actualizar filas respecto a la fila $V_P$

##### Actualizar $r$

| $V_B$      | $r$ | $x_1$         | $x_2$          | $x_3$ | $s_1$ | $R_1$         | $Solución$    |
| ---------- | --- | ------------- | -------------- | ----- | ----- | ------------- | ------------- |
| $r$        | $1$ | $2$           | $-1$           | $3$   | $0$   | $0$           | $8$           |
| $x_3$      | $0$ | $\frac{2}{3}$ | $\frac{-1}{3}$ | $1$   | $0$   | $\frac{1}{3}$ | $\frac{8}{3}$ |
| $-3x_3$    | $0$ | $-2$          | $1$            | $-3$  | $0$   | $-1$          | $-8$          |
| $r=r-3x_3$ | $1$ | $0$           | $0$            | $0$   | $0$   | $-1$          | $0$           |

##### Actualizar $s_1$

| $V_B$         | $r$ | $x_1$          | $x_2$          | $x_3$ | $s_1$ | $R_1$          | $Solución$     |
| ------------- | --- | -------------- | -------------- | ----- | ----- | -------------- | -------------- |
| $s_1$         | $0$ | $1$            | $2$            | $1$   | $1$   | $0$            | $10$           |
| $x_3$         | $0$ | $\frac{2}{3}$  | $\frac{-1}{3}$ | $1$   | $0$   | $\frac{1}{3}$  | $\frac{8}{3}$  |
| $-x_3$        | $0$ | $-\frac{2}{3}$ | $\frac{1}{3}$  | $-1$  | $0$   | $-\frac{1}{3}$ | $-\frac{8}{3}$ |
| $s_1=s_1-x_3$ | $0$ | $\frac{1}{3}$  | $\frac{7}{3}$  | $0$   | $1$   | $-\frac{1}{3}$ | $\frac{22}{3}$ |

#### Actualizar tabla con filas actualizadas

| $V_B$ | $r$ | $x_1$         | $x_2$          | $x_3$ | $s_1$ | $R_1$          | $Solución$     |
| ----- | --- | ------------- | -------------- | ----- | ----- | -------------- | -------------- |
| $r$   | $1$ | $0$           | $0$            | $0$   | $0$   | $-1$           | $0$            |
| $s_1$ | $0$ | $\frac{1}{3}$ | $\frac{7}{3}$  | $0$   | $1$   | $-\frac{1}{3}$ | $\frac{22}{3}$ |
| $x_3$ | $0$ | $\frac{2}{3}$ | $\frac{-1}{3}$ | $1$   | $0$   | $\frac{1}{3}$  | $\frac{8}{3}$  |

> Como la solución de $r$ nos da $0$. Significa que el problema si tiene solución factible y podemos proseguir a la fase 2.

## Fase 2

> Eliminar columnas artificiales. $R_1$ ya no será parte de la solución.

### Definición del problema

$Z - 5x_1 - 12x_2 - 4x_3 = 0$

$\frac{1}{3}x_1 + \frac{7}{3}x_2 + s_1 = \frac{22}{3}$

$\frac{2}{3}x_1 - \frac{1}{3}x_2 + x_3 = \frac{8}{3}$

$x_1, x_2, x_3, s_1 \geq 0$

| $V_B$ | $Z$ | $x_1$         | $x_2$          | $x_3$ | $s_1$ | $Solución$     |
| ----- | --- | ------------- | -------------- | ----- | ----- | -------------- |
| $Z$   | $1$ | $-5$          | $-12$          | $-4$  | $0$   | $0$            |
| $s_1$ | $0$ | $\frac{1}{3}$ | $\frac{7}{3}$  | $0$   | $1$   | $\frac{22}{3}$ |
| $x_3$ | $0$ | $\frac{2}{3}$ | $\frac{-1}{3}$ | $1$   | $0$   | $\frac{8}{3}$  |

> La fila Z no es congruente a la solución, así que corregiremos Z.

$Z - C_{x_3}x_3$

| $V_B$      | $Z$ | $x_1$          | $x_2$           | $x_3$ | $s_1$ | $Solución$     |
| ---------- | --- | -------------- | --------------- | ----- | ----- | -------------- |
| $Z$        | $1$ | $-5$           | $-12$           | $-4$  | $0$   | $0$            |
| $x_3$      | $0$ | $\frac{2}{3}$  | $\frac{-1}{3}$  | $1$   | $0$   | $\frac{8}{3}$  |
| $4x_3$     | $0$ | $\frac{8}{3}$  | $\frac{-4}{3}$  | $4$   | $0$   | $\frac{32}{3}$ |
| $Z=Z+4x_3$ | $1$ | $\frac{-7}{3}$ | $\frac{-40}{3}$ | $0$   | $0$   | $\frac{32}{3}$ |

### Tabla inicial

| $V_B$ | $Z$ | $x_1$          | $x_2$           | $x_3$ | $s_1$ | $Solución$     |
| ----- | --- | -------------- | --------------- | ----- | ----- | -------------- |
| $Z$   | $1$ | $\frac{-7}{3}$ | $\frac{-40}{3}$ | $0$   | $0$   | $\frac{32}{3}$ |
| $s_1$ | $0$ | $\frac{1}{3}$  | $\frac{7}{3}$   | $0$   | $1$   | $\frac{22}{3}$ |
| $x_3$ | $0$ | $\frac{2}{3}$  | $\frac{-1}{3}$  | $1$   | $0$   | $\frac{8}{3}$  |

## Primera iteración

### $V_E$ y $V_P$

$V_E=x_2$

| $V_B$ | Columna $V_E$  | Columna $Solución$ | Relación mínima                                 | Válida |
| ----- | -------------- | ------------------ | ----------------------------------------------- | ------ |
| $s_1$ | $\frac{7}{3}$  | $\frac{22}{3}$     | $\frac{\frac{22}{3}}{\frac{7}{3}}=\frac{22}{7}$ | Sí     |
| $x_3$ | $\frac{-1}{3}$ | $\frac{8}{3}$      | $\frac{\frac{8}{3}}{\frac{-1}{3}}=-8$           | No     |

$V_P = s_1$

#### Actualizar fila $V_P$

| $V_B$         | $Z$ | $x_1$         | $x_2$         | $x_3$ | $s_1$         | $Solución$     |
| ------------- | --- | ------------- | ------------- | ----- | ------------- | -------------- |
| $s_1$         | $0$ | $\frac{1}{3}$ | $\frac{7}{3}$ | $0$   | $1$           | $\frac{22}{3}$ |
| $s_1 \to x_2$ | $0$ | $\frac{1}{7}$ | $1$           | $0$   | $\frac{3}{7}$ | $\frac{22}{7}$ |

| $V_B$ | $Z$ | $x_1$          | $x_2$           | $x_3$ | $s_1$         | $Solución$     |
| ----- | --- | -------------- | --------------- | ----- | ------------- | -------------- |
| $Z$   | $1$ | $\frac{-7}{3}$ | $\frac{-40}{3}$ | $0$   | $0$           | $\frac{32}{3}$ |
| $x_2$ | $0$ | $\frac{1}{7}$  | $1$             | $0$   | $\frac{3}{7}$ | $\frac{22}{7}$ |
| $x_3$ | $0$ | $\frac{2}{3}$  | $\frac{-1}{3}$  | $1$   | $0$           | $\frac{8}{3}$  |

#### Actualizar filas respecto a la fila $V_P$

##### Actualizar $Z$

| $V_B$                     | $Z$ | $x_1$           | $x_2$           | $x_3$ | $s_1$          | $Solución$       |
| ------------------------- | --- | --------------- | --------------- | ----- | -------------- | ---------------- |
| $Z$                       | $1$ | $\frac{-7}{3}$  | $\frac{-40}{3}$ | $0$   | $0$            | $\frac{32}{3}$   |
| $x_2$                     | $0$ | $\frac{1}{7}$   | $1$             | $0$   | $\frac{3}{7}$  | $\frac{22}{7}$   |
| $\frac{40}{3}x_2$         | $0$ | $\frac{40}{21}$ | $\frac{40}{3}$  | $0$   | $\frac{40}{7}$ | $\frac{880}{21}$ |
| $Z = Z + \frac{40}{3}x_2$ | $1$ | $\frac{-3}{7}$  | $0$             | $0$   | $\frac{40}{7}$ | $\frac{368}{7}$  |

##### Actualizar $x_3$

| $V_B$                      | $Z$ | $x_1$          | $x_2$          | $x_3$ | $s_1$         | $Solución$      |
| -------------------------- | --- | -------------- | -------------- | ----- | ------------- | --------------- |
| $x_3$                      | $0$ | $\frac{2}{3}$  | $\frac{-1}{3}$ | $1$   | $0$           | $\frac{8}{3}$   |
| $x_2$                      | $0$ | $\frac{1}{7}$  | $1$            | $0$   | $\frac{3}{7}$ | $\frac{22}{7}$  |
| $\frac{1}{3}x_2$           | $0$ | $\frac{1}{21}$ | $\frac{1}{3}$  | $0$   | $\frac{1}{7}$ | $\frac{22}{21}$ |
| $x_3 = Z + \frac{1}{3}x_2$ | $0$ | $\frac{5}{7}$  | $0$            | $1$   | $\frac{1}{7}$ | $\frac{26}{7}$  |

#### Actualizar tabla con filas actualizadas

| $V_B$ | $Z$ | $x_1$          | $x_2$ | $x_3$ | $s_1$          | $Solución$      |
| ----- | --- | -------------- | ----- | ----- | -------------- | --------------- |
| $Z$   | $1$ | $\frac{-3}{7}$ | $0$   | $0$   | $\frac{40}{7}$ | $\frac{368}{7}$ |
| $x_2$ | $0$ | $\frac{1}{5}$  | $1$   | $0$   | $0$            | $\frac{22}{5}$  |
| $x_3$ | $0$ | $\frac{5}{7}$  | $0$   | $1$   | $\frac{1}{7}$  | $\frac{26}{7}$  |

## Segunda iteración

### $V_E$ y $V_P$

$V_E=x_1$

| $V_B$ | $Z$ | $x_1$          | $x_2$ | $x_3$ | $s_1$          | $Solución$      |
| ----- | --- | -------------- | ----- | ----- | -------------- | --------------- |
| $x_3$ | $0$ | $\frac{5}{7}$  | $0$   | $1$   | $\frac{1}{7}$  | $\frac{26}{7}$  |

| $V_B$ | Columna $V_E$ | Columna $Solución$ | Relación mínima                                     | Válida |
| ----- | ------------- | ------------------ | --------------------------------------------------- | ------ |
| $x_2$ | $\frac{1}{5}$ | $\frac{22}{5}$     | $\frac{\frac{22}{5}}{\frac{1}{5}}=22$               | Sí     |
| $x_3$ | $\frac{5}{7}$ | $\frac{26}{7}$     | ==$\frac{\frac{26}{7}}{\frac{5}{7}}=\frac{26}{5}$== | Sí     |

$V_P = x_3$



----

Nota: las variables iniciales primales en el método fueron $x_4$, $R$ las cuales corresponden a
las variables $y_1 y y_2$.
